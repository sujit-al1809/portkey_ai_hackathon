services:
  - type: web
    name: portkey-backend
    env: python
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: python -c "import sys; sys.path.insert(0, 'backend'); from dashboard_api import app; app.run(host='0.0.0.0', port=int(__import__('os').getenv('PORT', 8000)), debug=False)"
    envVars:
      - key: PORTKEY_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: COHERE_API_KEY
        sync: false
      - key: DATABASE_URL
        value: "sqlite:///./optimization.db"
      - key: FLASK_ENV
        value: production
      - key: SECRET_KEY
        sync: false
      - key: CORS_ORIGINS
        sync: false
      - key: PORT
        value: "8000"
